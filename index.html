<!DOCTYPE html>
<meta charset="utf-8">

<head>
<!-- Assets -->
<script src="https://d3js.org/d3.v4.min.js"></script>

<script src="assets/d3.v6.js"></script>
<script src="assets/d3-legend.min.js"></script>

<!-- Scripts -->
<script src="scripts/initialize.js"></script>
<script src="index.js"></script>
<script src="scripts/zoom.js"></script>
<script src="scripts/links.js"></script>
<script src="scripts/bee.js"></script>
<script src="scripts/states.js"></script>
<script src="scripts/water.js"></script>
<script src="scripts/legend.js"></script>
<script src="scripts/projection.js"></script>
<script src="scripts/alerts.js"></script>



<!-- Styles -->
<link rel="stylesheet" href="styles/style.css">

<!-- Rubik font from Google -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@700&family=Rubik:wght@900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Yantramanav:wght@900&display=swap" rel="stylesheet">

<script src="assets/jquery-1.12.4.js"></script>
<script src="assets/jquery-ui.js"></script>

<link rel="stylesheet" href="assets/jquery-ui.css">
</head>

<body>

<div class="tooltip">Hover over me
  <span class="tooltiptext">Tooltip text</span>
</div>

<div id='settings'>
  <div style="padding:1px 3px;">
    <label for="direction-select" style="font-size:16px;">Direction:</label>
    <select name="direction-select" id="direction-select" onchange="if (lonks) lonks.remove();" style="width:137px;">
      <option value="in-mover">In-movers (I)</option>
      <option value="out-mover">Out-movers (O)</option>
      <option value="net">Net Movers (N)</option>
    </select>
  </div>
  <div style="padding:1px 3px;">
    <label for="Links" style="font-size:16px;">Links (L):</label>
    <input type="checkbox" id="links-checkbox" name="Links" value="Links" onclick="draw()">
    <input id="links-number" type="number" value="5" style="width:40px">
    <div class="tooltip">
      <img src="assets/i-icon.png" class="icon-i">
      <span class="tooltiptext">Tooltip text</span>
    </div>
  </div>
  <br>
  <div style="padding:1px 3px;">
    <label for="color-2" style="font-size:16px;">Out-mover Color:</label>
    <input type="color" class="color-select" id="color-2" name="color-2" value="#005700" onchange="draw()"><br>
    <label for="color-1" style="font-size:16px;">In-mover Color:</label>
    <input type="color" class="color-select" id="color-1" name="color-1" value="#8B0000" onchange="draw()"><br>
    <label for="color-3" style="font-size:16px;">Highlight Color:</label>
    <input type="color" class="color-select" id="color-3" name="color-3" value="#FF69B4" onchange="draw()"><br>
  </div>
  <br>
  <div style="padding:1px 3px;">
    <button type="button" onclick="preset(0)">Reset Map</button>
    <div class="tooltip">
      <img src="assets/i-icon.png" class="icon-i">
      <span class="tooltiptext">Tooltip text</span>
    </div>

    <br><br>

    <button type="button" onclick="preset(1)">California Net Movers</button>
    <div class="tooltip">
      <img src="assets/i-icon.png" class="icon-i">
      <span class="tooltiptext">Tooltip text</span>
    </div>

    <br>

    <button type="button" onclick="preset(4)">Delaware Net Movers</button>
    <div class="tooltip">
      <img src="assets/i-icon.png" class="icon-i">
      <span class="tooltiptext">Tooltip text</span>
    </div>

    <br>

    <button type="button" onclick="preset(5)">New York Net Movers</button>
    <div class="tooltip">
      <img src="assets/i-icon.png" class="icon-i">
      <span class="tooltiptext">Tooltip text</span>
    </div>

    <br>
    <button type="button" onclick="preset(6)">Puerto Rico Net Movers</button>
    <div class="tooltip">
      <img src="assets/i-icon.png" class="icon-i">
      <span class="tooltiptext">Tooltip text</span>
    </div>

    <br><br>

    <button type="button" onclick="preset(2)">North Dakota In-movers</button>
    <div class="tooltip">
      <img src="assets/i-icon.png" class="icon-i">
      <span class="tooltiptext">Tooltip text</span>
    </div>

    <br>

    <button type="button" onclick="preset(3)">North Dakota Out-movers</button>
    <div class="tooltip">
      <img src="assets/i-icon.png" class="icon-i">
      <span class="tooltiptext">Tooltip text</span>
    </div>

    <br>
  </div>
</div>


<div id="site-title">
  <span style="font-size: 50px; color:black; text-decoration-line: underline; text-decoration-thickness: 3px;">State-to-State Migration Flows</span><br>
  <span>Source:
    <a href="https://www.census.gov/data/tables/time-series/demo/geographic-mobility/state-to-state-migration.html">American Community Survey, U.S. Census Bureau (2019)</a>
  </span>
</div>

<div class="heading">
  <div class="title">
      <span id="title-state">National</span>
      <span id="title-direction">In-movers</span>
      <img src="assets/i-icon.png" class="info-button" onclick="alert()">
  </div>
  <div class="info">
    <div id="info-1">Hover over a state to learn more...</div>
    <div id="info-2"></div>
  </div>
</div>

<div id="wrapper" style="position: fixed; top: 60px;">
  <!-- SVG lives here -->
</div>

<script>

// Calculate SVG dimensions
const width = window.innerWidth-20
const height = 550
const bubble_height = Math.max(350, window.innerHeight*0.33)+25
const map_height = window.innerHeight - 124 - bubble_height

$(".title").css("margin-top", window.innerHeight - 60 - bubble_height)

// Define the SVG inside of the wrapper
const svg = d3.select("#wrapper")
.append("svg")
.attr("width", width)
.attr("height", map_height)
.call(zoom);

const svg2 = d3.select("#wrapper")
.append("svg")
.attr("id","svg2")
.attr("width", width)
.attr("height", bubble_height)
.call(zoom);

$(".title").css("margin-top", window.innerHeight - 75 - bubble_height)
$("#svg2").css("margin-top", $(".title").css("height"))



// Create two high-level groups, for the water and land components, respectively
const ocean = svg.append("g");
const land = svg.append("g");

// Define the map projection and scale, then translate to proper position
const projection = geoAlbersUsaPr()
.scale(2.1*map_height)
.translate([width/2, map_height/2]);

// Define path generator based on map projection
const path = d3.geoPath().projection(projection)

initialize()
loadData()

</script>
